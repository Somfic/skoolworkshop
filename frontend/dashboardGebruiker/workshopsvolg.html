<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            rel="stylesheet"
            type="text/css"
            href="../../../opmaak/opmaak.css"
        />
    </head>

    <body>
        <ul class="topnav">
          <li>
            <a href="#1">Naam</a>
          </li>
          <li>
            <a href="mijnAccount.html">Mijn account</a>
          </li>
          </li>
          <li class="dropdown">
            <a href="workshops.html">Workshops</a>
            <div class="dropdown-content">
              <a href="workshopsvolg.html">Gevolgde workshops</a>
            </div>
          </li>
          <li>
            <a href="facturen.html">Facturen</a>
          </li>
          <li>
            <a href="coupon.html">Coupon</a>
          </li>
          <li class="right"><a href="#">Uitloggen</a></li>
        </ul>

        <div class="container">
            <h1>Lijst van alle workshops</h1>
            <table class="table table-striped table-hover">
                <thead>
                    <th>Naam</th>
                    <th>Beschrijving</th>
                    <th>Kosten</th>
                    <th>VervolgKosten</th>
                    <th>Categorie</th>
                    <th></th>
                </thead>
                <!-- id gelijk zetten aan id in script-->
                <tbody id="tableUserList"></tbody>
            </table>
        </div>

        <script src="/scripts/requests.js"></script>
        <script src="/scripts/cookie.js"></script>

        <script>
             checkUserCookie()
            getUser();
            function getUser() {
                sendGetRequest(apiUrl + '/api/workshop/getall/' + Id)
                    .then((data) => {
                        console.log(data.result);
                        let tableBody = document.getElementById(
                            'tableUserList'
                        );

                        let rows = '';
                        if (data.result) {
                            data.result.forEach((item) => {
                                console.log('wolla we zijn bij getall ', item);
                                rows += // Column namen van de data die je opvraagt
                                    `<tr><td>${item.Naam}</td>` + //
                                    `<td>${item.Beschrijving}</td>` +
                                    `<td>${item.Kosten}</td>` +
                                    `<td>${item.VervolgKosten}</td>` +
                                    `<td>${item.Categorie}</td>` +
                                    `<td><button onclick="deleteWorkshop('` +
                                    item.Naam +
                                    `')"> Delete </button> </td></tr>`;

                                console.log(item.Naam);
                            });

                            tableBody.innerHTML = rows; // Stop de aangemaakte tablerows in de body van de eerder gemaakt table
                        } else {
                            let niks = '';
                            tableBody.innerHTML = niks;
                        }
                    })
                    .catch((error) => {
                        alert('Error fetching workshops!');
                        console.log(
                            'There has been a problem with your fetch operation:',
                            error
                        );
                    });
            }
        </script>

        <script>
            function deleteWorkshop(Naam) {
                checkAdminCookie();

                sendPostRequest(apiUrl + '/api/workshop/delete/' + Naam)
                    .then((data) => {
                        if (data.error) {
                            alert(data.error);
                        } else {
                            alert(data.message);
                            getUser();
                        }
                    })
                    .catch((error) => {
                        alert('Error deleting user!');
                        console.error(
                            'There has been a problem with your fetch operation:',
                            error
                        );
                    });
            }
        </script>
    </body>
</html>
